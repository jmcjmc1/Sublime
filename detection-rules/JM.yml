name: "QR code detected in attachment"
description: |
  Detects one or more QR codes within an inbound (only) email attachment (image, PDF, or Office Document) contains a QR code. 
  In order to detect QR Phishing which attempts to move the user's session to a mobile device and so bypass standard URL filters.
type: "rule"
severity: "medium"
source: |
  type.inbound
  // look at incoming mail only, ignore internal (auth) or outbound //
  and any(attachments,
  // examines all files attached to the email of file types: //
    (
      .file_type == "pdf" or
      .file_type == "jpg" or
      .file_type == "png" or
      .file_type in $file_types_images or 
      // or do it better for images using predefined list of image types //
      .file_extension in $file_extensions_macros
    )
    and any(file.explode(.), .scan.qr.type == "url")
  )
authors:
  - name: "Juliet McMullen, Sublime Community"
tags:
  - "Quishing"
  - "QR Code"
attack_types:
  - "Credential Phishing"
tactics_and_techniques:
  - "QR code"
  - "Image as content"
detection_methods:
  - "QR code analysis"

  - "File analysis"







